set(DirectXShaderCompiler_PATCHFILE ${CMAKE_CURRENT_LIST_DIR}/DirectXShaderCompiler.patch)
set(DirectXShaderCompiler_PATCH_COMMAND git apply ${DirectXShaderCompiler_PATCHFILE})

if (EXISTS ${DirectXShaderCompiler_PATCHFILE})
	set(DirectXShaderCompiler_EXTRA_ARGS PATCH_COMMAND ${DirectXShaderCompiler_PATCH_COMMAND})
endif()

CPMAddPackage(
  NAME DirectXShaderCompiler
  GITHUB_REPOSITORY "microsoft/DirectXShaderCompiler"
  GIT_TAG a742bb62b5b54388d3ab24fb1415216499a9d223
  ${DirectXShaderCompiler_EXTRA_ARGS}
  OPTIONS
	"LLVM_ENABLE_ASSERTIONS ON"
	"ENABLE_SPIRV_CODEGEN ON"
	"DXC_DISABLE_LIT ON"
	"LLVM_LIT_ARGS -v"
	"DXC_COVERAGE OFF"
	"LLVM_TEST_VALUE OFF"
	"LLVM_INCLUDE_TESTS OFF"
	"CLANG_INCLUDE_TESTS OFF"
	"CMAKE_EXPORT_COMPILE_COMMANDS ON"
	"LLVM_APPEND_VC_REV ON"
	"LLVM_DEFAULT_TARGET_TRIPLE dxil-ms-dx"
	"LLVM_ENABLE_EH ON"
	"LLVM_ENABLE_RTTI ON"
	"LLVM_INCLUDE_DOCS OFF"
	"LLVM_INCLUDE_EXAMPLES OFF"
	"LLVM_OPTIMIZED_TABLEGEN OFF"
	"LLVM_TARGETS_TO_BUILD None"
	"LIBCLANG_BUILD_STATIC ON"
	"CLANG_BUILD_EXAMPLES OFF"
	"CLANG_CL OFF"
	"CLANG_ENABLE_ARCMT OFF"
	"CLANG_ENABLE_STATIC_ANALYZER OFF"
	"HLSL_INCLUDE_TESTS OFF"
	"ENABLE_SPIRV_CODEGEN ON"
	"SPIRV_BUILD_TESTS OFF"
	"LLVM_ENABLE_TERMINFO OFF")